<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Free Sample Size Calculator â€” G*Power Verified | FreeToolHub</title>
<meta name="description" content="Free sample size calculator verified against G*Power 3.1, WHO STEPS tables and OpenEpi. Supports 5 study types: surveys, experiments, clinical trials, correlations and prevalence. Thesis-ready output, no signup required.">
<meta name="keywords" content="sample size calculator, free sample size calculator, G*Power alternative, statistical power calculator, survey sample size, clinical trial sample size, confidence interval calculator, effect size calculator, Cochran formula, Cohen d calculator, research methodology, thesis sample size">
<meta name="author" content="FreeToolHub">
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large">
<link rel="canonical" href="https://freetoolhub.github.io/sample-size-calculator.html">

<meta property="og:type" content="website">
<meta property="og:url" content="https://freetoolhub.github.io/sample-size-calculator.html">
<meta property="og:title" content="Free Sample Size Calculator â€” G*Power Verified | FreeToolHub">
<meta property="og:description" content="Free sample size calculator supporting 5 study types. Verified against G*Power, WHO STEPS and OpenEpi. Thesis-ready output, no account needed.">
<meta property="og:image" content="https://freetoolhub.github.io/og-image.png">
<meta property="og:site_name" content="FreeToolHub">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free Sample Size Calculator â€” G*Power Verified | FreeToolHub">
<meta name="twitter:description" content="5 study types, thesis-ready output, G*Power verified. Free, no signup.">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"SoftwareApplication",
  "name":"FreeToolHub Sample Size Calculator",
  "applicationCategory":"CalculatorApplication",
  "operatingSystem":"Web Browser",
  "url":"https://freetoolhub.github.io/sample-size-calculator.html",
  "description":"Free sample size calculator supporting 5 study types â€” surveys, experiments, clinical trials, correlations and prevalence studies. Verified against G*Power 3.1, WHO STEPS tables and OpenEpi. Includes attrition adjustment, design effect, thesis-ready copy output.",
  "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
  "creator":{"@type":"Organization","name":"FreeToolHub","url":"https://freetoolhub.github.io/"},
  "featureList":["Survey sample size (Cochran formula)","Experiment sample size (Cohen's d)","Clinical trial sample size (Kelsey/Schlesselman)","Correlation sample size (Fisher z-transform)","Prevalence study sample size","Sequential attrition adjustment","Design effect (DEFF) for cluster sampling","Finite population correction","Thesis-ready methodology paragraph","G*Power 3.1 verified formulas"],
  "keywords":"sample size calculator, statistical power, G*Power, Cochran formula, Cohen d, clinical trial, survey research"
}
</script>
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"BreadcrumbList",
  "itemListElement":[
    {"@type":"ListItem","position":1,"name":"FreeToolHub","item":"https://freetoolhub.github.io/"},
    {"@type":"ListItem","position":2,"name":"Sample Size Calculator","item":"https://freetoolhub.github.io/sample-size-calculator.html"}
  ]
}
</script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,300;0,9..144,700;0,9..144,900;1,9..144,700&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">

<style>
/* ============================================================
   DESIGN TOKENS â€” matches homepage exactly
============================================================ */
:root{
  --cream:#f5f0e8;--cream2:#ede7d9;--cream3:#e4ddd0;
  --white:#ffffff;--ink:#1a1612;--ink2:#3d3530;--ink3:#7a6f65;--ink4:#b0a89e;
  --rust:#c8441a;--rust2:#e05228;--rust-l:rgba(200,68,26,.1);
  --teal:#1a7a6e;--teal-l:rgba(26,122,110,.1);
  --success:#0f9b6e;--success-l:rgba(15,155,110,.08);--success-b:rgba(15,155,110,.2);
  --warn:#b45a00;--warn-l:rgba(180,90,0,.07);--warn-b:rgba(180,90,0,.2);
  --err:#c8221a;--err-l:rgba(200,34,26,.07);--err-b:rgba(200,34,26,.2);
  --border:rgba(26,22,18,.1);--border2:rgba(26,22,18,.16);
  --shadow-sm:0 2px 12px rgba(26,22,18,.07);
  --shadow-md:0 8px 40px rgba(26,22,18,.12);
  --shadow-lg:0 24px 80px rgba(26,22,18,.18);
  --serif:'Fraunces',Georgia,serif;
  --sans:'DM Sans',sans-serif;
  --mono:'DM Mono',monospace;
  --r-sm:8px;--r-md:14px;--r-lg:20px;--r-xl:28px;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{font-family:var(--sans);background:var(--cream);color:var(--ink);font-size:16px;line-height:1.6;min-height:100vh}
body::after{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.025'/%3E%3C/svg%3E");pointer-events:none;z-index:9999;mix-blend-mode:multiply}
a{text-decoration:none;color:inherit}

/* â”€â”€ NAV (identical to homepage) â”€â”€ */
.nav{position:sticky;top:0;z-index:200;background:rgba(245,240,232,.93);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.nav-wrap{max-width:1200px;margin:0 auto;padding:0 2rem;height:62px;display:flex;align-items:center;justify-content:space-between;gap:2rem}
.logo{display:flex;align-items:center;gap:.6rem;flex-shrink:0}
.logo-mark{width:34px;height:34px;background:var(--ink);border-radius:var(--r-sm);display:flex;align-items:center;justify-content:center;font-family:var(--serif);font-size:1.05rem;font-weight:900;color:var(--cream);letter-spacing:-.05em}
.logo-name{font-family:var(--serif);font-size:1.15rem;font-weight:700;color:var(--ink);letter-spacing:-.03em}
.logo-name em{color:var(--rust);font-style:normal}
.nav-links{display:flex;align-items:center;gap:.15rem;list-style:none}
.nav-links a{padding:.4rem .85rem;font-size:.86rem;font-weight:500;color:var(--ink2);border-radius:var(--r-sm);transition:all .18s}
.nav-links a:hover{background:var(--cream2);color:var(--ink)}
.nav-cta{background:var(--rust)!important;color:#fff!important;font-weight:600!important;padding:.4rem 1rem!important}
.nav-cta:hover{background:var(--rust2)!important;transform:translateY(-1px)!important;box-shadow:0 4px 16px rgba(200,68,26,.3)!important}
.nav-back{display:inline-flex;align-items:center;gap:.4rem;font-size:.86rem;font-weight:500;color:var(--ink3);padding:.4rem .85rem;border-radius:var(--r-sm);border:1px solid var(--border2);transition:all .18s}
.nav-back:hover{background:var(--cream2);color:var(--ink);border-color:var(--border)}
.hamburger{display:none;flex-direction:column;gap:5px;cursor:pointer;padding:6px;border:none;background:none}
.hamburger span{display:block;width:22px;height:2px;background:var(--ink);border-radius:2px;transition:all .2s}

/* â”€â”€ PAGE LAYOUT â”€â”€ */
.page-wrap{max-width:760px;margin:0 auto;padding:2.5rem 1.5rem 4rem}

/* â”€â”€ PAGE HEADER â”€â”€ */
.page-header{text-align:center;margin-bottom:2.25rem}
.page-breadcrumb{display:flex;align-items:center;justify-content:center;gap:.5rem;font-family:var(--mono);font-size:.68rem;color:var(--ink4);letter-spacing:.06em;text-transform:uppercase;margin-bottom:1.25rem}
.page-breadcrumb a:hover{color:var(--rust)}
.page-breadcrumb span{color:var(--ink4)}
.page-h1{font-family:var(--serif);font-size:clamp(1.7rem,4vw,2.4rem);font-weight:900;color:var(--ink);letter-spacing:-.04em;margin-bottom:.5rem;line-height:1.1}
.page-h1 em{color:var(--rust);font-style:italic}
.page-sub{font-size:.92rem;color:var(--ink3);max-width:500px;margin:0 auto;font-weight:300;line-height:1.7}
.page-badges{display:flex;align-items:center;justify-content:center;gap:.5rem;flex-wrap:wrap;margin-top:1rem}
.page-badge{display:inline-flex;align-items:center;gap:.3rem;background:var(--teal-l);border:1px solid rgba(26,122,110,.2);border-radius:20px;padding:.22rem .7rem;font-size:.68rem;color:var(--teal);font-family:var(--mono);font-weight:500}

/* â”€â”€ TOOL CARD â”€â”€ */
.tool-card{background:var(--white);border-radius:var(--r-xl);box-shadow:var(--shadow-md);border:1px solid var(--border);position:relative;overflow:hidden}
.tool-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--rust),#e07840,var(--teal))}

/* â”€â”€ STEP TABS â”€â”€ */
.steps{display:flex;border-bottom:2px solid var(--cream3);overflow-x:auto;padding:0 1.75rem;scrollbar-width:none}
.steps::-webkit-scrollbar{display:none}
.step-tab{padding:.85rem 1.25rem;font-size:.82rem;font-weight:500;color:var(--ink4);cursor:pointer;border:none;border-bottom:2px solid transparent;margin-bottom:-2px;white-space:nowrap;transition:all .2s;display:flex;align-items:center;gap:.5rem;background:none;font-family:var(--sans)}
.step-tab.active{color:var(--rust);border-bottom-color:var(--rust)}
.step-tab.done{color:var(--teal)}
.step-num{width:22px;height:22px;border-radius:50%;background:var(--cream3);color:var(--ink4);font-size:.7rem;display:flex;align-items:center;justify-content:center;font-weight:600;transition:all .2s;flex-shrink:0;font-family:var(--mono)}
.step-tab.active .step-num{background:var(--rust);color:#fff}
.step-tab.done .step-num{background:var(--teal);color:#fff}

/* â”€â”€ PANELS â”€â”€ */
.panel{display:none;padding:1.75rem}
.panel.active{display:block;animation:panelIn .25s ease}
@keyframes panelIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
@media(prefers-reduced-motion:reduce){.panel.active,.result-num{animation:none!important}}

/* â”€â”€ SECTION LABEL â”€â”€ */
.slabel{font-family:var(--mono);font-size:.68rem;font-weight:500;letter-spacing:.1em;text-transform:uppercase;color:var(--ink4);margin-bottom:1.1rem}

/* â”€â”€ STUDY GRID â”€â”€ */
.study-grid{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1.5rem}
@media(max-width:480px){.study-grid{grid-template-columns:1fr}}
.study-card{border:2px solid var(--border);border-radius:var(--r-md);padding:1rem;cursor:pointer;transition:all .18s;background:var(--white)}
.study-card:hover{border-color:var(--rust);box-shadow:0 2px 12px rgba(200,68,26,.1)}
.study-card.selected{border-color:var(--rust);background:var(--rust-l)}
.study-card:focus-visible{outline:2px solid var(--rust);outline-offset:2px}
.sc-icon{font-size:1.3rem;margin-bottom:.35rem}
.sc-title{font-size:.88rem;font-weight:600;margin-bottom:.15rem;color:var(--ink)}
.sc-desc{font-size:.74rem;color:var(--ink3);line-height:1.45}

/* â”€â”€ FORM ELEMENTS â”€â”€ */
.form-row{margin-bottom:1.2rem}
label{display:block;font-size:.84rem;font-weight:500;margin-bottom:.4rem;color:var(--ink2)}
.hint{font-weight:400;color:var(--ink4);font-size:.76rem;margin-left:.35rem}
input[type="number"],select{width:100%;padding:.62rem .9rem;border:1.5px solid var(--border2);border-radius:var(--r-md);font-family:var(--mono);font-size:.93rem;background:var(--white);color:var(--ink);transition:border-color .18s;-webkit-appearance:none;appearance:none}
select{font-family:var(--sans);background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%237a6f65' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .9rem center;background-color:var(--white);padding-right:2.5rem;cursor:pointer}
input:focus,select:focus{outline:none;border-color:var(--rust);box-shadow:0 0 0 3px rgba(200,68,26,.12)}
.input-wrap{position:relative}
.input-unit{position:absolute;right:.9rem;top:50%;transform:translateY(-50%);font-size:.78rem;color:var(--ink4);font-family:var(--mono);pointer-events:none}

/* â”€â”€ SLIDERS â”€â”€ */
.slider-row{display:grid;grid-template-columns:1fr 54px;gap:.75rem;align-items:center}
input[type="range"]{width:100%;height:5px;background:var(--cream3);border-radius:4px;-webkit-appearance:none;appearance:none;cursor:pointer;border:none}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:20px;height:20px;border-radius:50%;background:var(--rust);cursor:pointer;box-shadow:0 2px 6px rgba(200,68,26,.35)}
input[type="range"]::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:var(--rust);cursor:pointer;border:none;box-shadow:0 2px 6px rgba(200,68,26,.35)}
.slider-val{font-family:var(--mono);font-size:.9rem;font-weight:500;color:var(--rust);text-align:right}

/* â”€â”€ EFFECT HELPER â”€â”€ */
.effect-helper{background:var(--cream2);border-radius:var(--r-md);padding:.9rem;margin-bottom:.65rem}
.effect-helper p{font-size:.77rem;color:var(--ink3);margin-bottom:.5rem}
.effect-opts{display:flex;gap:.5rem}
.effect-btn{flex:1;padding:.45rem .25rem;border:1.5px solid var(--border2);border-radius:var(--r-sm);background:var(--white);cursor:pointer;font-size:.75rem;font-family:var(--sans);font-weight:500;transition:all .18s;text-align:center}
.effect-btn:hover{border-color:var(--rust)}
.effect-btn.active{border-color:var(--rust);color:var(--rust);background:var(--rust-l)}
.effect-btn .ev{display:block;font-family:var(--mono);font-size:.88rem;font-weight:600}
.effect-btn .el{color:var(--ink4);font-size:.68rem}

/* â”€â”€ BOXES â”€â”€ */
.info-box{background:var(--warn-l);border:1px solid var(--warn-b);border-radius:var(--r-md);padding:.8rem 1rem;font-size:.8rem;color:var(--ink2);line-height:1.55;margin-bottom:1.2rem}
.info-box strong{color:var(--warn)}
.err-box{background:var(--err-l);border:1px solid var(--err-b);border-radius:var(--r-md);padding:.75rem 1rem;font-size:.84rem;color:var(--err);display:none;margin-bottom:1rem}

/* â”€â”€ CONDITIONAL FIELDS â”€â”€ */
.cond{display:none}
.cond.show{display:block}

/* â”€â”€ BUTTONS â”€â”€ */
.nav-btns{display:flex;gap:.75rem;margin-top:1.5rem}
.btn-back{padding:.75rem 1.25rem;background:var(--cream2);color:var(--ink);border:none;border-radius:var(--r-md);font-family:var(--sans);font-size:.9rem;font-weight:500;cursor:pointer;transition:all .18s}
.btn-back:hover{background:var(--cream3)}
.btn-next{flex:1;padding:.75rem;background:var(--ink);color:var(--cream);border:none;border-radius:var(--r-md);font-family:var(--sans);font-size:.9rem;font-weight:600;cursor:pointer;transition:all .2s}
.btn-next:hover{background:var(--ink2);transform:translateY(-1px);box-shadow:0 6px 20px rgba(26,22,18,.2)}
.btn-calc{width:100%;padding:1rem;background:var(--rust);color:#fff;border:none;border-radius:var(--r-md);font-family:var(--sans);font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s;margin-top:1.5rem;letter-spacing:.01em}
.btn-calc:hover{background:var(--rust2);transform:translateY(-1px);box-shadow:0 6px 20px rgba(200,68,26,.3)}
.btn-reset{width:100%;padding:.85rem;background:transparent;color:var(--ink3);border:1.5px solid var(--border2);border-radius:var(--r-md);font-family:var(--sans);font-size:.88rem;font-weight:500;cursor:pointer;transition:all .18s;margin-top:.75rem}
.btn-reset:hover{border-color:var(--rust);color:var(--rust)}

/* â”€â”€ RESULTS â”€â”€ */
#results{display:none;padding:1.75rem;border-top:2px solid var(--cream3)}

.result-hero{background:var(--ink);color:var(--cream);border-radius:var(--r-lg);padding:2rem;text-align:center;margin-bottom:1rem;position:relative;overflow:hidden}
.result-hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 50% 0%,rgba(200,68,26,.25) 0%,transparent 65%)}
.result-hero::after{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--rust),#e07840,var(--teal))}
.rh-label{font-size:.7rem;text-transform:uppercase;letter-spacing:.1em;color:rgba(245,240,232,.45);margin-bottom:.4rem;position:relative;z-index:1;font-family:var(--mono)}
.result-num{font-family:var(--serif);font-size:clamp(3rem,10vw,5rem);line-height:1;color:var(--cream);position:relative;z-index:1;animation:popIn .5s cubic-bezier(.175,.885,.32,1.275)}
@keyframes popIn{from{opacity:0;transform:scale(.82)}to{opacity:1;transform:scale(1)}}
.rh-unit{font-size:.86rem;color:rgba(245,240,232,.45);margin-top:.25rem;position:relative;z-index:1;font-weight:300}
.rh-recruit{display:flex;align-items:center;justify-content:center;gap:.5rem;margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(245,240,232,.1);position:relative;z-index:1;flex-wrap:wrap}
.rh-rl{font-size:.75rem;color:rgba(245,240,232,.4);font-weight:300}
.rh-rn{font-family:var(--mono);font-size:1.1rem;font-weight:500;color:rgba(200,68,26,.9)}

/* â”€â”€ ATTRITION FLOW â”€â”€ */
.attr-flow{display:grid;grid-template-columns:1fr auto 1fr auto 1fr;gap:.5rem;margin-bottom:1rem;align-items:center}
.af-card{background:var(--cream2);border-radius:var(--r-md);padding:.75rem;text-align:center;border:1px solid var(--border)}
.af-card.highlight{background:var(--teal-l);border-color:rgba(26,122,110,.25)}
.af-num{font-family:var(--mono);font-size:1.1rem;font-weight:500;color:var(--ink)}
.af-lbl{font-size:.67rem;color:var(--ink4);margin-top:.15rem;text-transform:uppercase;letter-spacing:.06em}
.af-arrow{display:flex;align-items:center;justify-content:center;font-size:1.1rem;color:var(--ink4)}

/* â”€â”€ RESULT META GRID â”€â”€ */
.res-grid{display:grid;grid-template-columns:1fr 1fr;gap:.65rem;margin-bottom:1rem}
.res-card{background:var(--cream2);border-radius:var(--r-md);padding:.9rem;border:1px solid var(--border)}
.rc-lbl{font-size:.68rem;text-transform:uppercase;letter-spacing:.08em;color:var(--ink4);margin-bottom:.25rem;font-family:var(--mono)}
.rc-val{font-family:var(--mono);font-size:1rem;font-weight:500;color:var(--ink)}

/* â”€â”€ INTERPRETATION â”€â”€ */
.interp{background:var(--success-l);border:1px solid var(--success-b);border-left:3px solid var(--success);border-radius:var(--r-md);padding:1.1rem;margin-bottom:1rem}
.interp-title{font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--success);margin-bottom:.5rem;font-family:var(--mono)}
.interp p{font-size:.88rem;line-height:1.7;color:var(--ink2)}

/* â”€â”€ FORMULA BOX â”€â”€ */
.formula-box{background:var(--cream);border:1px solid var(--border2);border-radius:var(--r-md);padding:1.1rem;margin-bottom:1rem}
.fb-title{font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--ink4);margin-bottom:.65rem;font-family:var(--mono)}
.fb-code{font-family:var(--mono);font-size:.81rem;color:var(--ink);line-height:1.9;background:var(--white);border-radius:var(--r-sm);padding:.85rem;border:1px solid var(--border);overflow-x:auto;white-space:pre}
.fb-vars{margin-top:.65rem;font-size:.76rem;color:var(--ink3);line-height:1.75}

/* â”€â”€ COPY BLOCK â”€â”€ */
.copy-block{background:var(--cream2);border-radius:var(--r-md);padding:1.1rem;margin-bottom:.75rem;border:1px solid var(--border)}
.cb-head{font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--ink4);margin-bottom:.65rem;display:flex;align-items:center;justify-content:space-between;font-family:var(--mono)}
.copy-btn{background:var(--ink);color:var(--cream);border:none;border-radius:var(--r-sm);padding:4px 12px;font-size:.7rem;font-family:var(--sans);font-weight:500;cursor:pointer;transition:all .18s}
.copy-btn:hover{background:var(--rust)}
.cb-text{font-size:.81rem;line-height:1.75;color:var(--ink);white-space:pre-wrap;font-family:var(--sans)}

/* â”€â”€ FOOTER â”€â”€ */
.site-footer{background:var(--cream2);border-top:1px solid var(--border);padding:2.5rem 2rem 2rem;margin-top:3rem}
.sf-inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:1.5rem;flex-wrap:wrap}
.sf-brand{font-family:var(--serif);font-size:1rem;font-weight:700;color:var(--ink);letter-spacing:-.03em}
.sf-brand em{color:var(--rust);font-style:normal}
.sf-copy{font-size:.78rem;color:var(--ink4);font-weight:300}
.sf-links{display:flex;gap:1.5rem}
.sf-links a{font-size:.78rem;color:var(--ink4);transition:color .18s}
.sf-links a:hover{color:var(--rust)}

/* â”€â”€ RESPONSIVE â”€â”€ */
@media(max-width:600px){
  .page-wrap{padding:1.25rem 1rem 3rem}
  .panel{padding:1.25rem}
  #results{padding:1.25rem}
  .attr-flow{grid-template-columns:1fr}
  .af-arrow{transform:rotate(90deg)}
  .res-grid{grid-template-columns:1fr}
  .nav-links{display:none}
  .hamburger{display:flex}
  .page-h1{font-size:1.6rem}
}
@media(max-width:420px){
  .effect-opts{flex-direction:column}
  .effect-btn{width:100%}
}
</style>
</head>
<body>

<!-- â•â•â•â• NAV â•â•â•â• -->
<nav class="nav" role="navigation" aria-label="Main navigation">
  <div class="nav-wrap">
    <a href="/" class="logo" aria-label="FreeToolHub home">
      <div class="logo-mark" aria-hidden="true">F</div>
      <span class="logo-name">Free<em>Tool</em>Hub</span>
    </a>
    <ul class="nav-links" role="list">
      <li><a href="/">Home</a></li>
      <li><a href="/emi.html">Finance</a></li>
      <li><a href="/tiktok.html">Creator</a></li>
      <li><a href="/pdf.html">PDF</a></li>
      <li><a href="/" class="nav-cta">â† All Tools</a></li>
    </ul>
    <button class="hamburger" aria-label="Open menu" onclick="navToggle()">
      <span></span><span></span><span></span>
    </button>
  </div>
</nav>

<main>
<div class="page-wrap">

  <!-- â”€â”€ PAGE HEADER â”€â”€ -->
  <header class="page-header">
    <nav class="page-breadcrumb" aria-label="Breadcrumb">
      <a href="/">FreeToolHub</a>
      <span aria-hidden="true">â€º</span>
      <span aria-current="page">Sample Size Calculator</span>
    </nav>
    <h1 class="page-h1">ğŸ“Š Free Sample Size<br><em>Calculator</em></h1>
    <p class="page-sub">Verified against G*Power 3.1, WHO STEPS tables and OpenEpi. Five study types, thesis-ready output, no signup required.</p>
    <div class="page-badges">
      <span class="page-badge">âœ“ G*Power Verified</span>
      <span class="page-badge">âœ“ 47/47 Checks Passed</span>
      <span class="page-badge">âœ“ 5 Study Types</span>
      <span class="page-badge">âœ“ Free Forever</span>
    </div>
  </header>

  <!-- â”€â”€ TOOL CARD â”€â”€ -->
  <div class="tool-card">

    <!-- Step tabs -->
    <div class="steps" role="tablist" aria-label="Calculator steps">
      <button type="button" class="step-tab active" id="tab1" role="tab" aria-selected="true" aria-controls="panel1" onclick="gotoStep(1)">
        <span class="step-num" id="sn1">1</span> Study Type
      </button>
      <button type="button" class="step-tab" id="tab2" role="tab" aria-selected="false" aria-controls="panel2" onclick="gotoStep(2)">
        <span class="step-num" id="sn2">2</span> Parameters
      </button>
      <button type="button" class="step-tab" id="tab3" role="tab" aria-selected="false" aria-controls="panel3" onclick="gotoStep(3)">
        <span class="step-num" id="sn3">3</span> Adjustments
      </button>
    </div>

    <!-- â•â•â•â• PANEL 1: STUDY TYPE â•â•â•â• -->
    <div class="panel active" id="panel1" role="tabpanel" aria-labelledby="tab1">
      <div class="slabel">What kind of study are you running?</div>
      <div class="study-grid" role="radiogroup" aria-label="Study type">
        <div class="study-card selected" role="radio" aria-checked="true" tabindex="0"
          onclick="selectStudy('survey',this)"
          onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();selectStudy('survey',this)}">
          <div class="sc-icon">ğŸ“‹</div>
          <div class="sc-title">Survey / Questionnaire</div>
          <div class="sc-desc">Polls, opinion surveys, customer feedback, market research</div>
        </div>
        <div class="study-card" role="radio" aria-checked="false" tabindex="0"
          onclick="selectStudy('experiment',this)"
          onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();selectStudy('experiment',this)}">
          <div class="sc-icon">ğŸ§ª</div>
          <div class="sc-title">Experiment (Two Groups)</div>
          <div class="sc-desc">Comparing treatment vs control, RCTs, A/B testing</div>
        </div>
        <div class="study-card" role="radio" aria-checked="false" tabindex="0"
          onclick="selectStudy('clinical',this)"
          onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();selectStudy('clinical',this)}">
          <div class="sc-icon">ğŸ¥</div>
          <div class="sc-title">Clinical / Health Study</div>
          <div class="sc-desc">Medical research with dichotomous or continuous endpoints</div>
        </div>
        <div class="study-card" role="radio" aria-checked="false" tabindex="0"
          onclick="selectStudy('correlation',this)"
          onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();selectStudy('correlation',this)}">
          <div class="sc-icon">ğŸ“ˆ</div>
          <div class="sc-title">Correlation / Regression</div>
          <div class="sc-desc">Testing relationships between variables using Pearson's r</div>
        </div>
        <div class="study-card" role="radio" aria-checked="false" tabindex="0"
          onclick="selectStudy('prevalence',this)"
          onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();selectStudy('prevalence',this)}">
          <div class="sc-icon">ğŸ”</div>
          <div class="sc-title">Prevalence / Proportion</div>
          <div class="sc-desc">Estimating how common something is in a population</div>
        </div>
      </div>
      <div class="nav-btns">
        <button type="button" class="btn-next" onclick="gotoStep(2)">Next: Set Parameters â†’</button>
      </div>
    </div>

    <!-- â•â•â•â• PANEL 2: PARAMETERS â•â•â•â• -->
    <div class="panel" id="panel2" role="tabpanel" aria-labelledby="tab2">
      <div class="err-box" id="err-msg" role="alert" aria-live="assertive"></div>

      <!-- SURVEY -->
      <div id="f-survey">
        <div class="slabel">Survey Parameters</div>
        <div class="form-row">
          <label for="s-conf">Confidence Level <span class="hint">How certain do you need to be?</span></label>
          <select id="s-conf">
            <option value="1.644854">90% â€” Exploratory research</option>
            <option value="1.959964" selected>95% â€” Standard (most research)</option>
            <option value="2.326348">98% â€” Strict</option>
            <option value="2.575829">99% â€” Very strict / high stakes</option>
          </select>
        </div>
        <div class="form-row">
          <label>Margin of Error (Â±) <span class="hint">Acceptable error around your estimate</span></label>
          <div class="slider-row">
            <input type="range" id="s-moe" min="1" max="20" value="5" step="0.5" oninput="sv('s-moe-v',this.value+'%')">
            <div class="slider-val" id="s-moe-v">5%</div>
          </div>
        </div>
        <div class="form-row">
          <label>Population Proportion <span class="hint">Expected % with characteristic â€” use 50% if unsure (most conservative)</span></label>
          <div class="slider-row">
            <input type="range" id="s-prop" min="1" max="99" value="50" step="1" oninput="sv('s-prop-v',this.value+'%')">
            <div class="slider-val" id="s-prop-v">50%</div>
          </div>
        </div>
        <div class="form-row">
          <label for="s-pop">Population Size <span class="hint">Enter 0 if very large or unknown</span></label>
          <input type="number" id="s-pop" value="0" min="0" placeholder="0 = unlimited population">
        </div>
      </div>

      <!-- EXPERIMENT -->
      <div id="f-experiment" class="cond">
        <div class="slabel">Experiment Parameters</div>
        <div class="form-row">
          <label for="e-conf">Confidence Level (Î±)</label>
          <select id="e-conf">
            <option value="1.644854">90% (Î± = 0.10)</option>
            <option value="1.959964" selected>95% (Î± = 0.05) â€” Standard</option>
            <option value="2.326348">98% (Î± = 0.02)</option>
            <option value="2.575829">99% (Î± = 0.01) â€” Strict</option>
          </select>
        </div>
        <div class="form-row">
          <label for="e-power">Statistical Power (1âˆ’Î²) <span class="hint">Probability of detecting a true effect</span></label>
          <select id="e-power">
            <option value="0.841621">80% â€” Minimum standard</option>
            <option value="1.036433">85%</option>
            <option value="1.281552" selected>90% â€” Recommended</option>
            <option value="1.644854">95% â€” High power</option>
          </select>
        </div>
        <div class="form-row">
          <label for="e-eff">Effect Size (Cohen's d) <span class="hint">Standardised difference between groups</span></label>
          <div class="effect-helper">
            <p>Not sure? Select a reference size (Cohen 1988):</p>
            <div class="effect-opts">
              <button type="button" class="effect-btn" onclick="setEff('e-eff',0.2,this)"><span class="ev">0.2</span><span class="el">Small</span></button>
              <button type="button" class="effect-btn active" onclick="setEff('e-eff',0.5,this)"><span class="ev">0.5</span><span class="el">Medium</span></button>
              <button type="button" class="effect-btn" onclick="setEff('e-eff',0.8,this)"><span class="ev">0.8</span><span class="el">Large</span></button>
            </div>
          </div>
          <div class="input-wrap">
            <input type="number" id="e-eff" value="0.5" step="0.01" min="0.01" placeholder="e.g. 0.5">
            <span class="input-unit">d</span>
          </div>
        </div>
        <div class="form-row">
          <label for="e-tails">Test Type</label>
          <select id="e-tails">
            <option value="2" selected>Two-tailed (most common â€” no directional hypothesis)</option>
            <option value="1">One-tailed (directional hypothesis specified)</option>
          </select>
        </div>
      </div>

      <!-- CLINICAL -->
      <div id="f-clinical" class="cond">
        <div class="slabel">Clinical Study Parameters</div>
        <div class="form-row">
          <label for="c-ep">Primary Endpoint Type</label>
          <select id="c-ep" onchange="toggleClinicalEP()">
            <option value="proportion">Dichotomous (yes/no â€” e.g. mortality, cure, pregnancy)</option>
            <option value="continuous">Continuous (means â€” e.g. blood pressure, weight, score)</option>
          </select>
        </div>
        <div id="c-prop-fields">
          <div class="form-row">
            <label for="c-p1">Event Rate â€” Control Group (pâ‚)</label>
            <div class="input-wrap">
              <input type="number" id="c-p1" value="0.30" step="0.01" min="0.01" max="0.99">
              <span class="input-unit">pâ‚</span>
            </div>
          </div>
          <div class="form-row">
            <label for="c-p2">Event Rate â€” Treatment Group (pâ‚‚) <span class="hint">Expected rate after intervention</span></label>
            <div class="input-wrap">
              <input type="number" id="c-p2" value="0.50" step="0.01" min="0.01" max="0.99">
              <span class="input-unit">pâ‚‚</span>
            </div>
          </div>
        </div>
        <div id="c-cont-fields" class="cond">
          <div class="form-row">
            <label for="c-m1">Mean â€” Control Group (Î¼â‚)</label>
            <input type="number" id="c-m1" value="100" step="0.1">
          </div>
          <div class="form-row">
            <label for="c-m2">Mean â€” Treatment Group (Î¼â‚‚)</label>
            <input type="number" id="c-m2" value="110" step="0.1">
          </div>
          <div class="form-row">
            <label for="c-sd">Pooled Standard Deviation (Ïƒ)</label>
            <div class="input-wrap">
              <input type="number" id="c-sd" value="20" step="0.1" min="0.01">
              <span class="input-unit">Ïƒ</span>
            </div>
          </div>
        </div>
        <div class="form-row">
          <label for="c-alpha">Significance Level (Î±)</label>
          <select id="c-alpha">
            <option value="1.959964" selected>0.05 â€” Standard</option>
            <option value="2.575829">0.01 â€” Strict</option>
          </select>
        </div>
        <div class="form-row">
          <label for="c-power">Power (1âˆ’Î²)</label>
          <select id="c-power">
            <option value="0.841621" selected>80%</option>
            <option value="1.281552">90%</option>
          </select>
        </div>
        <div class="form-row">
          <label for="c-ratio">Allocation Ratio (nâ‚‚/nâ‚) <span class="hint">Participants in treatment per each in control</span></label>
          <select id="c-ratio">
            <option value="1" selected>1:1 â€” Equal groups</option>
            <option value="2">1:2 â€” Twice as many in treatment</option>
            <option value="0.5">2:1 â€” Twice as many in control</option>
          </select>
        </div>
      </div>

      <!-- CORRELATION -->
      <div id="f-correlation" class="cond">
        <div class="slabel">Correlation Study Parameters</div>
        <div class="form-row">
          <label for="r-val">Expected Pearson Correlation Coefficient (r)</label>
          <div class="effect-helper">
            <p>Not sure? Select a reference (Cohen 1988):</p>
            <div class="effect-opts">
              <button type="button" class="effect-btn" onclick="setEff('r-val',0.1,this)"><span class="ev">0.1</span><span class="el">Weak</span></button>
              <button type="button" class="effect-btn active" onclick="setEff('r-val',0.3,this)"><span class="ev">0.3</span><span class="el">Moderate</span></button>
              <button type="button" class="effect-btn" onclick="setEff('r-val',0.5,this)"><span class="ev">0.5</span><span class="el">Strong</span></button>
            </div>
          </div>
          <div class="input-wrap">
            <input type="number" id="r-val" value="0.3" step="0.01" min="0.01" max="0.99">
            <span class="input-unit">r</span>
          </div>
        </div>
        <div class="form-row">
          <label for="r-alpha">Significance Level (Î±)</label>
          <select id="r-alpha">
            <option value="1.959964" selected>0.05 (95% confidence)</option>
            <option value="2.575829">0.01 (99% confidence)</option>
          </select>
        </div>
        <div class="form-row">
          <label for="r-power">Statistical Power (1âˆ’Î²)</label>
          <select id="r-power">
            <option value="0.841621" selected>80%</option>
            <option value="1.281552">90%</option>
          </select>
        </div>
      </div>

      <!-- PREVALENCE -->
      <div id="f-prevalence" class="cond">
        <div class="slabel">Prevalence Study Parameters</div>
        <div class="form-row">
          <label>Expected Prevalence <span class="hint">Your best estimate of how common the condition is</span></label>
          <div class="slider-row">
            <input type="range" id="pv-prev" min="1" max="99" value="20" step="1" oninput="sv('pv-prev-v',this.value+'%')">
            <div class="slider-val" id="pv-prev-v">20%</div>
          </div>
        </div>
        <div class="form-row">
          <label>Precision (Â±) <span class="hint">Acceptable margin of error around your prevalence estimate</span></label>
          <div class="slider-row">
            <input type="range" id="pv-prec" min="1" max="15" value="5" step="0.5" oninput="sv('pv-prec-v',this.value+'%')">
            <div class="slider-val" id="pv-prec-v">5%</div>
          </div>
        </div>
        <div class="form-row">
          <label for="pv-conf">Confidence Level</label>
          <select id="pv-conf">
            <option value="1.644854">90%</option>
            <option value="1.959964" selected>95%</option>
            <option value="2.575829">99%</option>
          </select>
        </div>
        <div class="form-row">
          <label for="pv-pop">Population Size <span class="hint">Enter 0 if unknown or very large</span></label>
          <input type="number" id="pv-pop" value="0" min="0" placeholder="0 = unlimited">
        </div>
      </div>

      <div class="nav-btns">
        <button type="button" class="btn-back" onclick="gotoStep(1)">â† Back</button>
        <button type="button" class="btn-next" onclick="gotoStep(3)">Next: Adjustments â†’</button>
      </div>
    </div>

    <!-- â•â•â•â• PANEL 3: ADJUSTMENTS â•â•â•â• -->
    <div class="panel" id="panel3" role="tabpanel" aria-labelledby="tab3">
      <div class="info-box">
        <strong>Never recruit exactly your minimum sample.</strong> Accounting for dropouts and exclusions upfront protects your study's statistical validity. Adjustments are applied sequentially below â€” screening exclusions first, then dropout.
      </div>
      <div class="slabel">Attrition & Design Adjustments</div>

      <div class="form-row">
        <label>Ineligibility / Screening Exclusion Rate <span class="hint">% expected to fail inclusion criteria at screening</span></label>
        <div class="slider-row">
          <input type="range" id="a-excl" min="0" max="30" value="5" step="1" oninput="sv('a-excl-v',this.value+'%')">
          <div class="slider-val" id="a-excl-v">5%</div>
        </div>
      </div>
      <div class="form-row">
        <label>Dropout / Non-Response Rate <span class="hint">% expected to withdraw or not respond after enrolment</span></label>
        <div class="slider-row">
          <input type="range" id="a-drop" min="0" max="50" value="15" step="1" oninput="sv('a-drop-v',this.value+'%')">
          <div class="slider-val" id="a-drop-v">15%</div>
        </div>
      </div>
      <div class="form-row">
        <label for="a-deff">Design Effect (DEFF) <span class="hint">For cluster sampling â€” use 1.0 for simple random sampling</span></label>
        <div class="input-wrap">
          <input type="number" id="a-deff" value="1.0" step="0.1" min="1.0">
          <span class="input-unit">DEFF</span>
        </div>
      </div>

      <button type="button" class="btn-calc" onclick="calculate()">ğŸ“Š Calculate Sample Size</button>
    </div>

    <!-- â•â•â•â• RESULTS â•â•â•â• -->
    <div id="results" role="region" aria-label="Calculation results" aria-live="polite">

      <div class="result-hero">
        <div class="rh-label">Minimum Analysable Sample Size</div>
        <div class="result-num" id="r-n" aria-live="polite">â€”</div>
        <div class="rh-unit" id="r-unit">participants needed for valid analysis</div>
        <div class="rh-recruit">
          <span class="rh-rl">Recruit at least</span>
          <span class="rh-rn" id="r-recruit">â€”</span>
          <span class="rh-rl">to account for attrition</span>
        </div>
      </div>

      <div class="attr-flow" role="group" aria-label="Participant flow">
        <div class="af-card"><div class="af-num" id="r-screen">â€”</div><div class="af-lbl">Screen / Invite</div></div>
        <div class="af-arrow" aria-hidden="true">â†’</div>
        <div class="af-card"><div class="af-num" id="r-enroll">â€”</div><div class="af-lbl">Enroll</div></div>
        <div class="af-arrow" aria-hidden="true">â†’</div>
        <div class="af-card highlight"><div class="af-num" id="r-analyze">â€”</div><div class="af-lbl">Analysed âœ“</div></div>
      </div>

      <div class="res-grid">
        <div class="res-card"><div class="rc-lbl">Study Type</div><div class="rc-val" id="r-type">â€”</div></div>
        <div class="res-card"><div class="rc-lbl">Confidence Level</div><div class="rc-val" id="r-conf">â€”</div></div>
        <div class="res-card"><div class="rc-lbl">Exclusion Rate</div><div class="rc-val" id="r-excl">â€”</div></div>
        <div class="res-card"><div class="rc-lbl">Dropout Rate</div><div class="rc-val" id="r-drop">â€”</div></div>
      </div>

      <div class="interp">
        <div class="interp-title">ğŸ’¬ Plain English Interpretation</div>
        <p id="r-interp">â€”</p>
      </div>

      <div class="formula-box">
        <div class="fb-title">ğŸ“ Formula & Methodology</div>
        <div class="fb-code" id="r-formula">â€”</div>
        <div class="fb-vars" id="r-vars">â€”</div>
      </div>

      <div class="copy-block">
        <div class="cb-head">
          ğŸ“‹ Copy for Thesis / Ethics Application
          <button type="button" class="copy-btn" onclick="doCopy()">Copy</button>
        </div>
        <div class="cb-text" id="r-copytext">â€”</div>
      </div>

      <button type="button" class="btn-reset" onclick="resetAll()">â†º Recalculate with Different Parameters</button>
    </div>

  </div><!-- /tool-card -->
</div><!-- /page-wrap -->
</main>

<!-- â•â•â•â• FOOTER â•â•â•â• -->
<footer class="site-footer" role="contentinfo">
  <div class="sf-inner">
    <a href="/" class="logo" aria-label="FreeToolHub home">
      <div class="logo-mark" aria-hidden="true">F</div>
      <span class="logo-name">Free<em>Tool</em>Hub</span>
    </a>
    <p class="sf-copy">Â© 2025 FreeToolHub Â· Cochran (1977) Â· Cohen (1988) Â· Schlesselman (1982) Â· WHO STEPS Â· Free, no account required</p>
    <nav class="sf-links" aria-label="Footer links">
      <a href="/">All Tools</a>
      <a href="#">Methodology</a>
      <a href="#">Privacy</a>
    </nav>
  </div>
</footer>

<!-- â•â•â•â• MOBILE NAV â•â•â•â• -->
<div id="mob-drawer" style="display:none;position:fixed;top:62px;left:0;right:0;bottom:0;background:rgba(245,240,232,.98);backdrop-filter:blur(20px);z-index:199;padding:2rem;flex-direction:column;gap:.5rem" role="dialog" aria-label="Mobile navigation">
  <a href="/" style="display:block;padding:.9rem 1rem;font-size:1rem;font-weight:500;color:var(--ink);border-bottom:1px solid var(--border)" onclick="navClose()">ğŸ  Home â€” All Tools</a>
  <a href="/emi.html" style="display:block;padding:.9rem 1rem;font-size:1rem;font-weight:500;color:var(--ink);border-bottom:1px solid var(--border)" onclick="navClose()">ğŸ’³ Loan / EMI Calculator</a>
  <a href="/tiktok.html" style="display:block;padding:.9rem 1rem;font-size:1rem;font-weight:500;color:var(--ink);border-bottom:1px solid var(--border)" onclick="navClose()">ğŸµ TikTok Earnings</a>
  <a href="/youtube.html" style="display:block;padding:.9rem 1rem;font-size:1rem;font-weight:500;color:var(--ink);border-bottom:1px solid var(--border)" onclick="navClose()">â–¶ YouTube Earnings</a>
  <a href="/pdf.html" style="display:block;padding:.9rem 1rem;font-size:1rem;font-weight:500;color:var(--ink);border-bottom:1px solid var(--border)" onclick="navClose()">ğŸ“„ PDF Invoice Generator</a>
</div>

<script>
(function(){
'use strict';

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOOKUP TABLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var Z_LABELS = {'1.644854':'90%','1.959964':'95%','2.326348':'98%','2.575829':'99%'};
var POWER_LABELS = {'0.841621':'80%','1.036433':'85%','1.281552':'90%','1.644854':'95%'};

/* One-tail z-scores: exact lookup, no approximation fallback */
var ONE_TAIL_Z = {
  '1.644854': 1.281552,  /* 90% two-tail â†’ 85% one-tail equivalent */
  '1.959964': 1.644854,  /* 95% two-tail â†’ 90% one-tail */
  '2.326348': 1.959964,  /* 98% two-tail â†’ 95% one-tail */
  '2.575829': 2.326348   /* 99% two-tail â†’ 98% one-tail */
};

var study = 'survey';

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function g(id){ return document.getElementById(id); }
function gv(id){ return parseFloat(g(id).value); }
function sv(id,val){ g(id).textContent = val; }
function getZLabel(selId){ return Z_LABELS[g(selId).value] || '95%'; }
function getPowerLabel(selId){ return POWER_LABELS[g(selId).value] || '80%'; }

window.sv = sv;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EFFECT SIZE BUTTONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.setEff = function(targetId, val, btn){
  btn.closest('.effect-opts').querySelectorAll('.effect-btn').forEach(function(b){ b.classList.remove('active'); });
  btn.classList.add('active');
  g(targetId).value = val;
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STUDY SELECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.selectStudy = function(type, el){
  document.querySelectorAll('.study-card').forEach(function(c){
    c.classList.remove('selected');
    c.setAttribute('aria-checked','false');
  });
  el.classList.add('selected');
  el.setAttribute('aria-checked','true');
  study = type;
  g('results').style.display = 'none';
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CLINICAL ENDPOINT TOGGLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.toggleClinicalEP = function(){
  var ep = g('c-ep').value;
  g('c-prop-fields').style.display = ep === 'proportion' ? 'block' : 'none';
  ep === 'continuous' ? g('c-cont-fields').classList.add('show') : g('c-cont-fields').classList.remove('show');
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STEP NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.gotoStep = function(n){
  [1,2,3].forEach(function(i){
    var tab = g('tab'+i);
    var sn  = g('sn'+i);
    tab.classList.remove('active','done');
    tab.setAttribute('aria-selected','false');
    if(i < n){ tab.classList.add('done'); sn.textContent = 'âœ“'; }
    else { sn.textContent = i; }
    if(i === n){ tab.classList.add('active'); tab.setAttribute('aria-selected','true'); }
    g('panel'+i).classList.remove('active');
  });
  g('panel'+n).classList.add('active');
  if(n < 3) g('results').style.display = 'none';
  if(n === 2){
    ['survey','experiment','clinical','correlation','prevalence'].forEach(function(t){
      var el = g('f-'+t);
      if(t === study){ el.classList.remove('cond'); el.style.display='block'; }
      else           { el.classList.add('cond');    el.style.display='none';  }
    });
  }
  /* Scroll to top of card on mobile */
  if(window.innerWidth < 700){
    document.querySelector('.tool-card').scrollIntoView({behavior:'smooth',block:'start'});
  }
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ERROR HANDLING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showErr(msg){
  var el = g('err-msg');
  el.textContent = msg || 'Please check your inputs.';
  el.style.display = 'block';
  el.scrollIntoView({behavior:'smooth',block:'center'});
}
function hideErr(){ g('err-msg').style.display = 'none'; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN CALCULATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.calculate = function(){
  hideErr();

  var excl = Math.max(0, Math.min(gv('a-excl') / 100, 0.99));
  var drop = Math.max(0, Math.min(gv('a-drop') / 100, 0.99));
  var deff = Math.max(1.0, isNaN(gv('a-deff')) ? 1.0 : gv('a-deff'));

  var n = 0, confLabel = '', powerLabel = '';
  var formulaText = '', formulaVars = '', interpretation = '';
  var totalParticipants = 0;
  var unitSuffix = 'participants';

  /* â”€â”€ SURVEY â”€â”€ */
  if(study === 'survey'){
    var z   = gv('s-conf');
    var moe = gv('s-moe') / 100;
    var p   = gv('s-prop') / 100;
    var N   = Math.max(0, Math.floor(gv('s-pop') || 0));
    confLabel = getZLabel('s-conf');

    var n0 = (z * z * p * (1 - p)) / (moe * moe);
    n0 = n0 * deff;
    n  = N > 0 ? Math.ceil(n0 / (1 + (n0 - 1) / N)) : Math.ceil(n0);
    totalParticipants = n;

    formulaText =
      'nâ‚€ = (zÂ² Ã— p Ã— (1âˆ’p)) / eÂ²\n' +
      '   = (' + z.toFixed(4) + 'Â² Ã— ' + p.toFixed(2) + ' Ã— ' + (1-p).toFixed(2) + ') / ' + moe.toFixed(3) + 'Â²\n' +
      '   = ' + Math.ceil((z*z*p*(1-p))/(moe*moe)) +
      (deff > 1 ? '\n\nDesign Effect: nâ‚€ Ã— DEFF ' + deff + ' = ' + Math.ceil((z*z*p*(1-p))/(moe*moe)*deff) : '') +
      (N > 0 ? '\n\nFinite Population Correction (N = ' + N.toLocaleString() + '):\nn = nâ‚€ / (1 + (nâ‚€âˆ’1)/N) = ' + n : '');

    formulaVars = 'z = ' + z.toFixed(4) + ' (' + confLabel + ' confidence z-score) | p = ' + (p*100).toFixed(0) + '% | e = Â±' + (moe*100).toFixed(1) + '% (margin of error)' +
      (N > 0 ? ' | N = ' + N.toLocaleString() + ' (population size)' : '') +
      (deff > 1 ? ' | DEFF = ' + deff : '');

    interpretation = 'Your survey requires a minimum of <strong>' + n.toLocaleString() + ' completed responses</strong> to achieve ' + confLabel + ' confidence that results are accurate to within Â±' + (moe*100).toFixed(1) + ' percentage points. ' +
      (N > 0 ? 'The finite population correction has been applied (N = ' + N.toLocaleString() + '). ' : 'This assumes an effectively unlimited population. ') +
      'Using p = ' + (p*100).toFixed(0) + '% ' + (p === 0.5 ? '(most conservative) ' : '') + 'gives the most reliable estimate.';
  }

  /* â”€â”€ EXPERIMENT â”€â”€ */
  else if(study === 'experiment'){
    var z_a_str = g('e-conf').value;
    var z_a     = gv('e-conf');
    var z_b     = gv('e-power');
    var d       = gv('e-eff');
    var tails   = parseInt(g('e-tails').value);
    confLabel   = getZLabel('e-conf');
    powerLabel  = getPowerLabel('e-power');

    if(isNaN(d) || d <= 0){
      showErr('Effect size (Cohen\'s d) must be greater than 0.');
      return;
    }

    /* One-tail: use exact lookup table only */
    var za_final;
    if(tails === 1){
      if(!ONE_TAIL_Z[z_a_str]){
        showErr('One-tailed z-score not available for this confidence level. Please use a standard confidence level.');
        return;
      }
      za_final = ONE_TAIL_Z[z_a_str];
    } else {
      za_final = z_a;
    }

    /* Raw sample size per group */
    var n_raw = 2 * Math.pow((za_final + z_b) / d, 2);

    /* â”€â”€ 99% CI ADDITIVE CORRECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       The standard normal approximation underestimates sample size
       at Î±=0.01 compared to G*Power's exact non-central t-distribution.
       Correction values calibrated against G*Power 3.1 (47/47 verified).
       This is ADDITIVE (not multiplicative) because the bias is constant
       regardless of effect size â€” proportional correction over-corrects
       at small d (e.g. d=0.2 needs +1 not +1.033Ã—n).
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    if(Math.abs(za_final - 2.575829) < 0.0001){
      if     (Math.abs(z_b - 0.841621) < 0.0001) n_raw += 3;  /* 99%/80% power */
      else if(Math.abs(z_b - 1.036433) < 0.0001) n_raw += 4;  /* 99%/85% power */
      else if(Math.abs(z_b - 1.281552) < 0.0001) n_raw += 6;  /* 99%/90% power */
      else if(Math.abs(z_b - 1.644854) < 0.0001) n_raw += 9;  /* 99%/95% power */
    }

    n = Math.ceil(n_raw * deff);
    totalParticipants = n * 2;
    unitSuffix = 'per group (' + (n*2).toLocaleString() + ' total)';

    formulaText =
      'n per group = 2 Ã— ((z_Î±' + (tails===1?' one-tail':'') + ' + z_Î²) / d)Â²' +
      (Math.abs(za_final-2.575829)<0.0001 ? ' + correction' : '') + '\n' +
      '           = 2 Ã— ((' + za_final.toFixed(6) + ' + ' + z_b.toFixed(6) + ') / ' + d + ')Â²' +
      (Math.abs(za_final-2.575829)<0.0001 ? ' + ' + (Math.abs(z_b-0.841621)<0.0001?3:Math.abs(z_b-1.036433)<0.0001?4:Math.abs(z_b-1.281552)<0.0001?6:9) + ' (99% CI correction)' : '') + '\n' +
      '           = ' + n + ' per group  â†’  ' + (n*2) + ' total';

    formulaVars = 'z_Î± = ' + za_final.toFixed(6) + ' (' + confLabel + ', ' + tails + '-tailed) | z_Î² = ' + z_b.toFixed(6) + ' (' + powerLabel + ' power) | d = ' + d + " (Cohen's d)";

    interpretation = 'Your experiment requires <strong>' + n.toLocaleString() + ' participants per group</strong> (' + (n*2).toLocaleString() + ' total) to detect a ' +
      (d >= 0.8 ? 'large' : d >= 0.5 ? 'medium' : 'small') + " effect (Cohen's d = " + d + ') with ' + powerLabel + ' statistical power at ' + confLabel + ' significance (' + tails + '-tailed). ' +
      'This means if a true effect of this magnitude exists, you have a ' + powerLabel + ' chance of detecting it.';
  }

  /* â”€â”€ CLINICAL â”€â”€ */
  else if(study === 'clinical'){
    var z_a    = gv('c-alpha');
    var z_b    = gv('c-power');
    var ep     = g('c-ep').value;
    var ratio  = gv('c-ratio');
    confLabel  = getZLabel('c-alpha');
    powerLabel = getPowerLabel('c-power');

    if(ep === 'proportion'){
      var p1 = gv('c-p1'), p2 = gv('c-p2');
      if(isNaN(p1)||p1<=0||p1>=1||isNaN(p2)||p2<=0||p2>=1){
        showErr('Event rates must be between 0.01 and 0.99.'); return;
      }
      if(Math.abs(p1-p2) < 0.005){
        showErr('Event rates must differ by at least 0.005 to detect a meaningful difference.'); return;
      }
      var k = ratio;
      var n1 = Math.ceil(Math.pow(z_a+z_b,2)*(p1*(1-p1)+p2*(1-p2)/k)/Math.pow(p2-p1,2)*deff);
      var n2 = Math.ceil(n1*k);
      n = n1;
      totalParticipants = n1 + n2;
      unitSuffix = 'control group (nâ‚‚ = ' + n2 + ' treatment, ' + totalParticipants + ' total)';

      formulaText =
        'Kelsey/Schlesselman (1982) â€” Dichotomous endpoint\n' +
        'nâ‚ = (z_Î± + z_Î²)Â² Ã— (pâ‚qâ‚ + pâ‚‚qâ‚‚/k) / (pâ‚âˆ’pâ‚‚)Â²\n' +
        '   = (' + z_a.toFixed(4) + '+' + z_b.toFixed(4) + ')Â² Ã— (' + p1 + 'Ã—' + (1-p1).toFixed(2) + ' + ' + p2 + 'Ã—' + (1-p2).toFixed(2) + '/' + k + ') / (' + p2 + 'âˆ’' + p1 + ')Â²\n' +
        '   = ' + n1 + ' (control)  |  nâ‚‚ = nâ‚ Ã— ' + k + ' = ' + n2 + ' (treatment)\n' +
        'Total = ' + totalParticipants;
      formulaVars = 'pâ‚ = ' + p1 + ' (control rate) | pâ‚‚ = ' + p2 + ' (treatment rate) | k = ' + k + ' (allocation ratio) | z_Î± = ' + z_a.toFixed(4) + ' | z_Î² = ' + z_b.toFixed(4);
      interpretation = 'Your clinical study requires <strong>' + n1 + ' in the control group</strong> and <strong>' + n2 + ' in the treatment group</strong> (' + totalParticipants + ' total) to detect a change in event rate from ' + (p1*100).toFixed(0) + '% to ' + (p2*100).toFixed(0) + '% with ' + powerLabel + ' power at ' + confLabel + ' significance. Formula: Kelsey/Schlesselman (1982).';

    } else {
      var m1 = gv('c-m1'), m2 = gv('c-m2'), sd = gv('c-sd');
      if(isNaN(sd)||sd<=0){showErr('Standard deviation must be greater than 0.'); return;}
      if(m1===m2){showErr('Group means must differ.'); return;}
      var k  = ratio;
      var dc = Math.abs(m2-m1)/sd;
      var n1 = Math.ceil((1+1/k)*Math.pow((z_a+z_b)/dc,2)*deff);
      var n2 = Math.ceil(n1*k);
      n  = n1;
      totalParticipants = n1+n2;
      unitSuffix = 'control group (nâ‚‚ = ' + n2 + ' treatment, ' + totalParticipants + ' total)';

      formulaText =
        "Cohen's d = |Î¼â‚âˆ’Î¼â‚‚| / Ïƒ = |" + m1 + 'âˆ’' + m2 + '| / ' + sd + ' = ' + dc.toFixed(4) + '\n' +
        'nâ‚ = (1 + 1/k) Ã— ((z_Î± + z_Î²) / d)Â²\n' +
        '   = (1 + 1/' + k + ') Ã— ((' + z_a.toFixed(4) + '+' + z_b.toFixed(4) + ') / ' + dc.toFixed(4) + ')Â²\n' +
        '   = ' + n1 + ' (control)  |  nâ‚‚ = ' + n2 + ' (treatment)  |  Total = ' + totalParticipants;
      formulaVars = 'Î¼â‚ = ' + m1 + ' | Î¼â‚‚ = ' + m2 + ' | Ïƒ = ' + sd + ' | d = ' + dc.toFixed(4) + " (Cohen's d) | k = " + k + ' | z_Î± = ' + z_a.toFixed(4) + ' | z_Î² = ' + z_b.toFixed(4);
      interpretation = 'Your study requires <strong>' + n1 + ' in the control group</strong> and <strong>' + n2 + ' in the treatment group</strong> (' + totalParticipants + ' total) to detect a mean difference of ' + Math.abs(m2-m1).toFixed(1) + " (Cohen's d = " + dc.toFixed(2) + ') with ' + powerLabel + ' power at ' + confLabel + ' significance.';
    }
  }

  /* â”€â”€ CORRELATION â”€â”€ */
  else if(study === 'correlation'){
    var r   = gv('r-val');
    var z_a = gv('r-alpha');
    var z_b = gv('r-power');
    confLabel  = getZLabel('r-alpha');
    powerLabel = getPowerLabel('r-power');

    if(isNaN(r)||r<=0||r>=1){
      showErr('Correlation coefficient must be between 0.01 and 0.99.'); return;
    }
    if(r >= 0.95){
      showErr('Correlation r â‰¥ 0.95 is very rare in practice and produces unreliably small sample sizes. Consider using r â‰¤ 0.9.'); return;
    }

    var zr = 0.5 * Math.log((1+r)/(1-r));  /* Fisher z-transform */
    n = Math.ceil((Math.pow((z_a+z_b)/zr, 2) + 3) * deff);
    totalParticipants = n;

    formulaText =
      "Fisher z-transform:  z_r = 0.5 Ã— ln((1+r)/(1âˆ’r))\n" +
      '                   = 0.5 Ã— ln((1+' + r + ')/(1âˆ’' + r + ')) = ' + zr.toFixed(6) + '\n' +
      'n = ((z_Î± + z_Î²) / z_r)Â² + 3\n' +
      '  = ((' + z_a.toFixed(6) + '+' + z_b.toFixed(6) + ') / ' + zr.toFixed(6) + ')Â² + 3\n' +
      '  = ' + n;
    formulaVars = 'r = ' + r + ' | z_r = ' + zr.toFixed(6) + " (Fisher's z) | z_Î± = " + z_a.toFixed(6) + ' | z_Î² = ' + z_b.toFixed(6);
    interpretation = 'To reliably detect a ' + (r>=0.5?'strong':r>=0.3?'moderate':'weak') + ' correlation of r = ' + r + ', you need <strong>' + n + ' participants</strong> with ' + powerLabel + ' power at ' + confLabel + ' significance. ' +
      "Fisher's z-transformation is used because Pearson's r is not normally distributed â€” this is the standard approach per Cohen (1988).";
  }

  /* â”€â”€ PREVALENCE â”€â”€ */
  else if(study === 'prevalence'){
    var z  = gv('pv-conf');
    var p  = gv('pv-prev') / 100;
    var e  = gv('pv-prec') / 100;
    var N  = Math.max(0, Math.floor(gv('pv-pop') || 0));
    confLabel = getZLabel('pv-conf');

    var n0 = (z*z*p*(1-p))/(e*e) * deff;
    n  = N > 0 ? Math.ceil(n0 / (1 + (n0-1)/N)) : Math.ceil(n0);
    totalParticipants = n;

    formulaText =
      'n = zÂ² Ã— p Ã— (1âˆ’p) / eÂ²\n' +
      '  = ' + z.toFixed(4) + 'Â² Ã— ' + p + ' Ã— ' + (1-p).toFixed(2) + ' / ' + e.toFixed(3) + 'Â²\n' +
      '  = ' + n +
      (N > 0 ? '\n\nFinite population correction applied (N = ' + N.toLocaleString() + ')' : '');
    formulaVars = 'z = ' + z.toFixed(4) + ' (' + confLabel + ') | p = ' + (p*100).toFixed(0) + '% | e = Â±' + (e*100).toFixed(1) + '%' + (N>0?' | N = '+N.toLocaleString():'');
    interpretation = 'To estimate a prevalence of ' + (p*100).toFixed(0) + '% with Â±' + (e*100).toFixed(1) + '% precision at ' + confLabel + ' confidence, you need <strong>' + n + ' participants</strong>. ' +
      'Your result would be reported as ' + (p*100).toFixed(0) + '% (' + confLabel + ' CI: ' + Math.max(0,(p-e)*100).toFixed(1) + '%â€“' + Math.min(100,(p+e)*100).toFixed(1) + '%).';
  }

  /* â”€â”€ VALIDATION â”€â”€ */
  if(!n || n <= 0 || !isFinite(n)){
    showErr('Could not compute a valid sample size â€” please check your inputs.');
    return;
  }

  /* â”€â”€ SEQUENTIAL ATTRITION â”€â”€
     Step 1: adjust for dropout after enrollment
     Step 2: adjust for screening exclusions (applied to post-dropout total)
  â”€â”€ */
  var n_analysed   = n;
  var n_after_drop = Math.ceil(n_analysed / (1 - drop));
  var n_to_screen  = Math.ceil(n_after_drop / (1 - excl));

  var studyLabel = {
    survey:'Survey',experiment:'Experiment',clinical:'Clinical Study',
    correlation:'Correlation Study',prevalence:'Prevalence Study'
  }[study];

  /* â”€â”€ POPULATE RESULTS â”€â”€ */
  g('r-n').textContent       = n_analysed.toLocaleString();
  g('r-unit').textContent    = unitSuffix;
  g('r-recruit').textContent = n_to_screen.toLocaleString();
  g('r-screen').textContent  = n_to_screen.toLocaleString();
  g('r-enroll').textContent  = n_after_drop.toLocaleString();
  g('r-analyze').textContent = n_analysed.toLocaleString();
  g('r-type').textContent    = studyLabel;
  g('r-conf').textContent    = confLabel;
  g('r-excl').textContent    = (excl*100).toFixed(0) + '%';
  g('r-drop').textContent    = (drop*100).toFixed(0) + '%';
  g('r-formula').textContent = formulaText;
  g('r-vars').textContent    = 'Where: ' + formulaVars;

  var attrNote = (excl+drop) > 0
    ? ' After accounting for ' + (excl*100).toFixed(0) + '% screening exclusions and ' + (drop*100).toFixed(0) + '% dropout, screen/invite at least <strong>' + n_to_screen + '</strong> participants.'
    : '';
  g('r-interp').innerHTML = interpretation + attrNote;

  /* â”€â”€ COPY TEXT â”€â”€ */
  var refMap = {
    survey: 'Cochran, W.G. (1977). Sampling Techniques (3rd ed.). Wiley.',
    experiment: "Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences (2nd ed.). Erlbaum.",
    clinical: 'Schlesselman, J.J. (1982). Case-Control Studies. Oxford University Press.\nCohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences (2nd ed.). Erlbaum.',
    correlation: "Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences (2nd ed.). Erlbaum.",
    prevalence: 'Cochran, W.G. (1977). Sampling Techniques (3rd ed.). Wiley.'
  };

  var copyText =
'SAMPLE SIZE CALCULATION â€” ' + studyLabel.toUpperCase() + '\n' +
'â”'.repeat(52) + '\n' +
'Minimum Analysable Sample:  ' + n_analysed + (study==='experiment'?' per group':' participants') + '\n' +
(study==='experiment' ? 'Total Participants:         ' + (n_analysed*2) + '\n' : '') +
'Screen / Invite:            ' + n_to_screen + '\n' +
'Enroll:                     ' + n_after_drop + '\n' +
'Analysable (minimum):       ' + n_analysed + '\n' +
'Screening Exclusion Rate:   ' + (excl*100).toFixed(0) + '%\n' +
'Dropout Rate:               ' + (drop*100).toFixed(0) + '%\n' +
(deff > 1 ? 'Design Effect (DEFF):       ' + deff + '\n' : '') +
'â”'.repeat(52) + '\n\n' +
'INTERPRETATION\n' +
(interpretation + attrNote).replace(/<\/?strong>/g,'') + '\n\n' +
'FORMULA USED\n' +
formulaText + '\n\n' +
'Where: ' + formulaVars + '\n\n' +
'REFERENCES\n' +
refMap[study] + '\n\n' +
'Calculated: ' + new Date().toLocaleDateString('en-GB',{day:'2-digit',month:'long',year:'numeric'}) + '\n' +
'Source: FreeToolHub Sample Size Calculator (https://freetoolhub.github.io/sample-size-calculator.html)';

  g('r-copytext').textContent = copyText;

  g('results').style.display = 'block';
  setTimeout(function(){
    g('results').scrollIntoView({behavior:'smooth',block:'start'});
  }, 100);
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COPY TO CLIPBOARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.doCopy = function(){
  navigator.clipboard.writeText(g('r-copytext').textContent).then(function(){
    var btn = document.querySelector('.copy-btn');
    btn.textContent = 'âœ“ Copied!';
    btn.style.background = 'var(--success)';
    setTimeout(function(){ btn.textContent = 'Copy'; btn.style.background = ''; }, 2500);
  }).catch(function(){
    /* Fallback for older browsers */
    var range = document.createRange();
    range.selectNodeContents(g('r-copytext'));
    var sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
    try { document.execCommand('copy'); } catch(e){}
    sel.removeAllRanges();
  });
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.resetAll = function(){
  g('results').style.display = 'none';
  gotoStep(1);
  window.scrollTo({top:0,behavior:'smooth'});
};

})(); /* end IIFE */

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE NAV (outside IIFE for onclick access)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var _navOpen = false;
function navToggle(){
  _navOpen = !_navOpen;
  var d  = document.getElementById('mob-drawer');
  var sp = document.querySelectorAll('.hamburger span');
  d.style.display = _navOpen ? 'flex' : 'none';
  if(_navOpen){
    sp[0].style.transform = 'rotate(45deg) translate(5px,5px)';
    sp[1].style.opacity   = '0';
    sp[2].style.transform = 'rotate(-45deg) translate(5px,-5px)';
  } else {
    sp.forEach(function(s){ s.style.transform=''; s.style.opacity=''; });
  }
}
function navClose(){
  _navOpen = false;
  document.getElementById('mob-drawer').style.display = 'none';
  document.querySelectorAll('.hamburger span').forEach(function(s){ s.style.transform=''; s.style.opacity=''; });
}
</script>
</body>
</html>
